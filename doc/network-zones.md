# ネットワークゾーンの設定
ネットワークゾーンは LXD のネットワークの DNS レコードを保持するのに使用します。

各ネットワークは下記の最大3つに関連します。

 - 正引き DNS レコード
 - IPv4 逆引き DNS レコード
 - IPv6 逆引き DNS レコード

これらはネットワーク設定の `dns.zone.forward`, `dns.zone.reverse.ipv4`,
`dns.zone.reverse.ipv6` で制御します。
LXD は全てのインスタンス、ネットワークゲートウェイ、ダウンストリーム (下流)
のネットワークポートの全てに対して正引きと逆引きのレコードを自動で管理します。

組み込みの DNS サーバを有効にするには、サーバ設定内の `core.dns_address`
を設定する必要があります。

組み込みの DNS サーバは AXFR 経由でのゾーン転送のみをサポートしており、
DNS レコードへの直接の問い合わせはできません。
つまりこの機能は外部の DNS サーバ (bind9, nsd, ...) の使用を前提としています。
外部の DNS サーバが LXD からの全体のゾーンを転送し、有効期限を過ぎたら更新し、
DNS 問い合わせに対する管理権限を持つ応答 (authoritative answers) を提供します。

ゾーン転送の認証はゾーン毎に設定され、各ゾーンでピアごとに IP アドレスと TSIG キーを設定して、
TSIG キーベースの認証を行います。

ゾーンはプロジェクトに属し、プロジェクトの `networks` 機能に紐づけられます。

ゾーン名は複数のプロジェクトをまたいでグローバルにユニークでなければなりません。
そのため、別のプロジェクト内の既存のゾーンのせいでゾーンの作成がエラーになることがありえます。

`restricted.networks.zones` プロジェクト設定キーによりプロジェクトを
特定のドメインとサブドメインに制限できます。

## プロパティ
ネットワークゾーンのプロパティは以下の通りです。

プロパティ         | 型         | 必須 | デフォルト値 | 説明
:--                | :--        | :--  | -            | :--
peers.NAME.address | string     | no   | -            | DNS サーバの IP アドレス
peers.NAME.key     | string     | no   | -            | サーバ用の TSIG キー
dns.nameservers    | string set | no   | -            | (NS レコード用の) DNS サーバの FQDN のカンマ区切りリスト
network.nat        | bool       | no   | true         | NAT されたサブネットのレコードを生成するかどうか

さらに、 `user.` キーの名前空間もユーザー提供の自由形式のキー・バリュー用にサポートされています。

## カスタムレコード
ゾーンに追加のレコードを追加することができます。
CLIでは、`lxc network zone record`で行います。

各レコードには、名前、エントリ数、オプションの説明があります。
ユーザーのキー／バリュー設定（`user.*`）を格納することもできます。各エントリは、タイプ、値、およびオプションのTTLで構成されます。

デュアルスタックのウェブサーバを追加したい場合は、`web`という名前のレコードを作成し、`user.*`を設定します。
`web`というレコードを作成し、説明として`Webサーバ`を設定し、そこに2つのエントリを作成します。
タイプが `A` で値が IPv4 アドレス (例: `192.0.2.1`) のものと、タイプが `AAAA` で値が IPv6 アドレス (例: `2001:db8::1` ) のものです。

TTLフィールドは、レコードにカスタムの TTL 値が必要な場合に設定できます。
そうでない場合は、デフォルトの300が使用されます。
