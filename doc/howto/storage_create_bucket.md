# ストレージバケットを作成するには

ストレージバケットは S3 プロトコルを使って公開されるオブジェクトストレージを提供します。

カスタムストレージボリュームとは異なり、ストレージバケットはインスタンスに追加されるのではなく、それらの URL を通してアプリケーションから直接アクセスされます。

詳細は {ref}`storage-buckets` を参照してください。

## ストレージバケットを作成する

ストレージプール内にストレージバケットを作成するには、以下のコマンドを使用します。

    lxc storage bucket create <pool_name> <bucket_name> [configuration_options...]

それぞれのドライバで利用可能なストレージバケット設定オプションの一覧については {ref}`storage-drivers` を参照してください。

クラスタメンバにストレージバケットを追加するには `--target` フラグを追加してください。

    lxc storage bucket create <pool_name> <bucket_name> --target=<cluster_member> [configuration_options...]

```{note}
ほとんどのストレージドライバでは、ストレージバケットはクラスタ間でリプリケートされず、作成されたメンバ上にのみ存在します。
この挙動は `cephobject` ストレージプールでは異なります。 `cephobject` ではバケットはどのクラスタメンバからも利用できます。
```

## ストレージバケットキーを作成する

アプリケーションがストレージバケットにアクセスするためには *アクセスキー* と *シークレットキー* からなる S3 クレデンシャルを使う必要があります。
特定のバケットに対して複数のセットのクレデンシャルを作成できます。

それぞれのクレデンシャルのセットにはキー名を設定します。
キー名は参照のためだけに用いられ、アプリケーションがクレデンシャルを使用する際に提供する必要はありません。

それぞれのクレデンシャルのセットには *ロール* が設定されます。それはバケットにどの操作を実行できるかを指定します。

使用可能なロールは以下のとおりです。

 - `admin` - バケットへのフルアクセス。
 - `read-only` - バケットへの読み取り専用アクセス (一覧とファイルの取得のみ)。

バケットキー作成時にロールが指定されない場合、使用されるロールは `read-only` になります。

ストレージバケットにクレデンシャルのセットを作成するには、以下のコマンドを使用します。

    lxc storage bucket key create <pool_name> <bucket_name> <key_name> [configuration_options...]

ストレージバケットに特定のロールを持つクレデンシャルのセットを作成するには、以下のコマンドを使用します。

    lxc storage bucket key create <pool_name> <bucket_name> <key_name> --role=admin [configuration_options...]

これらのコマンドはランダムなクレデンシャルキーのセットを生成し表示します。
